<!DOCTYPE html>
<html lang="en">
<head>

    <!-- GOOGLE ANALYTICS -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-147504302-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-147504302-1');
    </script>

    <title>Aggregating & Transforming Data with Python Pandas - Python Data Science Reference</title>

    <!--META TAGS-->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="See examples of how to aggregate and transform Pandas DataFrames using Groupby and Pivot functions. See how to aggregate sum, count, mean, standard deviation and min/max along with how to add a running total column to your DataFrames.">
    <!--SOCIAL MEDIA META TAGS-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!--STYLESHEETS-->
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <link href='../css/w3.css' rel='stylesheet' type="text/css">
    <link href='../css/page_style.css' rel='stylesheet' type='text/css'>

    <!--JAVASCRIPT FOR BURGER MENU-->
    <script>
        function w3_open() {
            document.getElementById("mySidebar").style.display = "block";
        }
        function w3_close() {
            document.getElementById("mySidebar").style.display = "none";
        }
    </script>
</head>

<body>
    <!--TOP BANNER-->


    <div id="top">
        <a href="../index.html"><img alt="Get Started with Data Science, Data Analysis and BI" id="banner" src="../img/AnalyseUp_Black(v2.2).png" ></a>
        <div class="sep"></div>
    </div>



    <!--SIDE MENU-->
    <div class="w3-sidebar w3-bar-block w3-collapse w3-card w3-animate-left" style="width:250px; top:0vh;" id="mySidebar">
        <button class="w3-bar-item w3-button w3-large w3-hide-large" onclick="w3_close()">Close &times;</button>
        <!--NEXT BUTTON
        <a href="python-lists-and-tuples.html" style="text-decoration: none;"><div id="next">Next</div></a>-->
        <p></p>
        <!--MENU LINKS-->
        <h6 class="side_title">Data Wrangling</h6>
            <a href="../python-data-science-reference/pandas-create-dataframe.html" class="w3-bar-item w3-button side_link" >Importing Data</a>
            <a href="../python-data-science-reference/pandas-selecting-dropping-and-renaming-columns.html" class="w3-bar-item w3-button side_link" >Select, Drop & Rename</a>
            <a href="../python-data-science-reference/pandas-filter-sort-and-sample.html" class="w3-bar-item w3-button side_link" >Filter, Sort & Sample</a>
            <a href="../python-data-science-reference/pandas-add-column.html" class="w3-bar-item w3-button side_link" >Add Columns</a>
            <a href="../python-data-science-reference/pandas-clean-data.html" class="w3-bar-item w3-button side_link" >Cleaning Data</a>
            <a href="../python-data-science-reference/pandas-dates.html" class="w3-bar-item w3-button side_link" >Dates & Time</a>
            <a href="../python-data-science-reference/pandas-join-data.html" class="w3-bar-item w3-button side_link" >Join Data</a>
            <a href="../python-data-science-reference/pandas-aggregating-data.html" class="w3-bar-item w3-button side_link" >Aggregate & Transform</a>
        <h6 class="side_title">Data Analysis</h6>
            <a href="../python-data-science-reference/pandas-exploring-data.html" class="w3-bar-item w3-button side_link" >Exploring Data</a>
            <a href="../python-data-science-reference/seaborn-continuous-variables.html" class="w3-bar-item w3-button side_link" >Plotting Continuous Variables</a>
            <a href="../python-data-science-reference/seaborn-discrete-variables.html" class="w3-bar-item w3-button side_link" >Plotting Discrete Variables</a>
        <h6 class="side_title">Machine Learning</h6>
            <a href="../python-data-science-reference/python-machine-learning-model-preparation.html" class="w3-bar-item w3-button side_link" >Data Preparation</a>
            <a href="../python-data-science-reference/python-machine-learning-linear-models.html" class="w3-bar-item w3-button side_link" >Linear Models</a>    
        <h6 class="side_title">Other Tutorials & Content</h6>
            <a href="../learn-python-for-data-science/python-variables-and-data-types.html" class="w3-bar-item w3-button side_link" >Learn Python for Data Science</a> 
            <a href="../learn-alteryx/alteryx-introduction.html" class="w3-bar-item w3-button side_link" >Learn Alteryx</a> 
            <a href="../blog/evaluation-metric-tunnel-vision.html" class="w3-bar-item w3-button side_link" >Blog</a>
                            <br/>
            <br/>
            <br/>
            <br/>
    </div>

    <!--MAIN PAGE----->
    <div class="w3-main" style="margin-left:250px; margin-right:200px;">
    <div>

        <!--MENU BUTTON-->
          <div class="h_left">
              <button class="w3-button w3-xlarge w3-hide-large" onclick="w3_open()" style="left:0;">&#9776;</button>
          </div>

          <!--HEADER-->
          <div class="h_right">
              <h1>Aggregating & Transforming Data with Python Pandas</h1>
          </div>

        <!--PY-REF-TOP-BANNER-->
        <div class='horizontal_ad'>
            <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
            <!-- top_ad_banner -->
            <ins class="adsbygoogle"
                 style="display:inline-block;width:100%;height:100px;
                        text-align:center;"
                 data-ad-client="ca-pub-4825364639199120"
                 data-ad-slot="6723525876"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>

        <!--CONTENT-->
        <div class="w3-container">

            <!--SOCIAL MEDIA BUTTONS-->
            <div class="share_buttons">
                  <!--TWITTER FOLLOW-->
                  <a href="https://twitter.com/AnalyseUp?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-show-count="false">Follow @AnalyseUp</a>
                  <!--TWEET-->
                  <a class="twitter-share-button" data-show-count="false">Tweet</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
            </div>
            <p class="txt_pad"></p>


            <h2 class="txt_pad">GroupBy and Count</h2>
            <p class="txt2">Create a new DataFrame that groups the Orders DataFrame by the distinct values in the Order_Date and ProductID columns and counts the Order_No column:</p>
            <div class="wide_box code_wide_box">
                  <div class="code_box_wide">
                      <div class="txt2 code">
                          <div class="code_line">
                              orders_by_day = orders.groupby([<span class=string>'Order_Date'</span>,
                              <span class=string>'ProductID'</span>],as_index=<span class=key_word>False</span>)
                              [<span class=string>'Order_No'</span>].count()
                          </div>
                      </div>
                    </div>
            </div>
            
            <h2 class="txt_pad">GroupBy and Sum</h2>
            <p class="txt2">Create a new DataFrame that groups the Orders DataFrame by the distinct values in the Order_Date and ProductID columns and sums the units column:</p>
            <div class="wide_box code_wide_box">
                  <div class="code_box_wide">
                      <div class="txt2 code">
                          <div class="code_line">
                              orders_by_day = orders.groupby([<span class=string>'Order_Date'</span>,
                              <span class=string>'ProductID'</span>],as_index=<span class=key_word>False</span>)
                              [<span class=string>'units'</span>].sum()
                          </div>
                      </div>
                    </div>
            </div>
            
            <h2 class="txt_pad">GroupBy and Agg</h2>
            <p class="txt2">Create a new DataFrame that groups the Orders DataFrame by the distinct values in the Genre column and determines the mean, maximum, minimum and standard deviation of each value:</p>
            <div class="wide_box code_wide_box">
                  <div class="code_box_wide">
                      <div class="txt2 code">
                          <div class="code_line">
                              genre_aggregations = products.groupby([<span class=string>'Genre'</span>],
                              as_index=<span class=key_word>False</span>)[<span class=string>'Cost'</span>].agg([<span class=string>'mean'</span>,<span class=string>'max'</span>,<span class=string>'min'</span>,<span class=string>'std'</span>]).reset_index()
                          </div>
                      </div>
                    </div>
            </div>
            
            <h2 class="txt_pad">Running Total Column</h2>
            <p class="txt2">Creates a column in the orders DataFrame that contains a running total for each ProductID over time:</p>
            <div class="wide_box code_wide_box">
                  <div class="code_box_wide">
                      <div class="txt2 code">
                          <div class="code_line">
                              orders.sort_values(by=[<span class=string>'Order_Date'</span>], 
                              inplace=<span class=key_word>True</span>)
                          </div>
                          <div class="code_line">
                              orders[<span class=keyword>'running_total'</span>] = orders.groupby([<span class=string>'ProductID'</span>],as_index=<span class=key_word>False</span>)
                              [<span class=string>'units'</span>].cumsum()
                          </div>
                      </div>
                    </div>
            </div>
            
            <h2 class="txt_pad">Pivot Data</h2>
            <p class="txt2">Creates a new DataFrame that pivots the orders Dataframe so the rows are product IDs, the columns are order dates and the cell values are units sold. Any NAs are filled with 0s.</p>
            <div class="wide_box code_wide_box">
                  <div class="code_box_wide">
                      <div class="txt2 code">
                          <div class="code_line">
                              units_by_day = orders.groupby([<span class=string>'Order_Date'</span>,<span class=string>'ProductID'</span>],as_index=<span class=key_word>False</span>)[<span class=string>'units'</span>].sum()
                          </div>
                          <div class="code_line">
                              units_by_day_pivot = units_by_day.pivot(index=<span class=string>'ProductID'</span>, columns=<span class=string>'Order_Date'</span>, values=<span class=string>'units'</span>).reset_index()
                          </div>
                          <div class="code_line">
                              units_by_day_pivot.fillna(<span class=number>0</span>, inplace=<span class=key_word>True</span>)
                          </div>
                      </div>
                    </div>
            </div>
            

            
        </div>
    </div>
    </div>
<!-------------------------------------FOOTER---------------------------------->
<div id="footer"></div>

<!--PY-REF-SIDE-BANNER-->
<div id="ad_bar" >
    <!-- side_bar_1 -->
    <ins class="adsbygoogle"
         style="display:block; margin-top: 10vh;"
         data-ad-client="ca-pub-4825364639199120"
         data-ad-slot="6943017726"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
    <script>
         (adsbygoogle = window.adsbygoogle || []).push({});
    </script>

</div>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

</body>
</html>
