<!DOCTYPE html>
<html lang="en">
<head>
    
    <!-- GOOGLE ANALYTICS -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-147504302-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-147504302-1');
    </script>

    <title>Join DataFrames with Pandas - AnalyseUp.com</title>
    
    <!--META TAGS-->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Learn how to use merge and concat to join two or more dataframes together. See how to utilise different join types and how to specicfy which columns to join on">
    <!--SOCIAL MEDIA META TAGS-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!--STYLESHEETS-->
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <link href='../css/w3.css' rel='stylesheet' type="text/css">
    <link href='../css/page_style.css' rel='stylesheet' type='text/css'> 

    <!--JAVASCRIPT FOR BURGER MENU-->
    <script>
        function w3_open() {
            document.getElementById("mySidebar").style.display = "block";
        }
        function w3_close() {
            document.getElementById("mySidebar").style.display = "none";
        }
    </script>
</head>
    
<body>
    <!--TOP BANNER-->


    <div id="top" style="max-width: 1080px">
        <a href="../index.html"><img alt="Get Started with Data Science, Data Analysis and BI" id="banner" src="../img/AnalyseUp_Black(v2.2).png" ></a>
        <div class="sep"></div>
    </div>
    

    
    <!--SIDE MENU-->
    <div class="w3-sidebar w3-bar-block w3-collapse w3-card w3-animate-left" style="width:250px; top:0vh;" id="mySidebar">
        <button class="w3-bar-item w3-button w3-large w3-hide-large" onclick="w3_close()">Close &times;</button>
        <!--NEXT BUTTON-->
        <a href="python-pandas-cleaning-data.html" style="text-decoration: none;"><div id="next">Next</div></a>
        <p></p>
        <!--MENU LINKS-->
        <h6 class="side_title">Python Basics</h6>
            <a href="python-variables-and-data-types.html" class="w3-bar-item w3-button side_link" >Variables & Comments</a>
            <a href="python-math-operators.html" class="w3-bar-item w3-button side_link" >Math Operators</a>
            <a href="python-sequence-data-types.html" class="w3-bar-item w3-button side_link" >Sequence Data Types</a>
            <a href="python-strings.html" class="w3-bar-item w3-button side_link" >Strings</a>
            <a href="python-lists-and-tuples.html" class="w3-bar-item w3-button side_link" >Lists & Tuples</a>
            <a href="python-comparison-and-logical-operators.html" class="w3-bar-item w3-button side_link" >Logical Operators</a>
            <a href="python-if-else-elif.html" class="w3-bar-item w3-button side_link" >Conditional Statements</a>
            <a href="python-loops.html" class="w3-bar-item w3-button side_link" >Loops</a>
            <a href="python-functions.html" class="w3-bar-item w3-button side_link" >Functions</a>
        <h6 class="side_title">Data Wrangling</h6>
            <a href="python-pandas-introduction.html" class="w3-bar-item w3-button side_link" >Pandas Introduction</a>
            <a href="python-pandas-importing-data.html" class="w3-bar-item w3-button side_link" >Importing Data</a>
            <a href="python-pandas-select-drop-rename-columns.html" class="w3-bar-item w3-button side_link" >Select, Drop & Rename</a>
            <a id="sel"  href="python-pandas-join-dataframes.html" class="w3-bar-item w3-button side_link" >Joining Data</a>
            <a href="python-pandas-cleaning-data.html" class="w3-bar-item w3-button side_link" >Cleaning Data</a>
            <a href="python-pandas-add-new-column-to-dataframe.html" class="w3-bar-item w3-button side_link" >Add Columns</a>
        <h6 class="side_title">Visualisation</h6>
            <a href="" class="w3-bar-item w3-button side_link" >Coming Soon</a>
        <h6 class="side_title">Machine Learning</h6>
            <a href="" class="w3-bar-item w3-button side_link" >Coming Soon</a>
        <h6 class="side_title">Other Tutorials & Content</h6>
            <a href="../python-data-science-reference/pandas-create-dataframe.html" class="w3-bar-item w3-button side_link" >Python Data Science Reference</a>
            <a href="../blog/evaluation-metric-tunnel-vision.html" class="w3-bar-item w3-button side_link" >Blog</a> 
                    <br/>
            <br/>
            <br/>
            <br/>
    </div>

    <!--MAIN PAGE----->
    <div class="w3-main" style="margin-left:250px; margin-right:200px;">
    <div>
            
        <!--MENU BUTTON-->
          <div class="h_left">
              <button class="w3-button w3-xlarge w3-hide-large" onclick="w3_open()" style="left:0;">&#9776;</button>
          </div>
        
          <!--HEADER-->
          <div class="h_right">
              <h1>Join DataFrames with Pandas</h1>
          </div>
        
        <!--CONTENT-->
        <div class="w3-container content_container">
            <!--TOP AD BANNER-->
            <div class='horizontal_ad'>
                <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                <!-- top_ad_banner -->
                <ins class="adsbygoogle"
                     style="display:inline-block;width:100%;height:100px;
                            text-align:center;"
                     data-ad-client="ca-pub-4825364639199120"
                     data-ad-slot="9902475134"></ins>
                <script>
                     (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            </div>
            <div class="share_buttons">
                  <!--TWITTER FOLLOW-->
                  <a href="https://twitter.com/AnalyseUp?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-show-count="false">Follow @AnalyseUp</a>
                  <!--TWEET-->
                  <a class="twitter-share-button" data-show-count="false">Tweet</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
                  <!--FACEBOOK SHARE-->
                  <iframe src="https://www.facebook.com/plugins/share_button.php?href=https%3A%2F%2Fwww.analyseup.com/learn-python-for-data-science/python-if-else-elif.html&layout=button_count&size=small&width=77&height=20&appId" width="77" height="20" style="border:none;overflow:hidden" scrolling="no" frameborder="0" allowTransparency="true" allow="encrypted-media"></iframe>
                  
            </div>
            <p></p>
            <p class="txt">Pandas provides us with functions for joining different data frames together to create one combined data frame. To achieve this, we can use many of the join functionality used in database languages like SQL.
            </p>
            <p class="txt2">If you have a background in SQL or any other language that makes use of joins then you can carry on with this part of the series. If youâ€™re not familiar with different join behaviour then we recommend going through our introduction to joins and join types, which you can find <a class="txt2 analyseup-link" href="../blog/join-types.html">here</a>
            </p>


            <h2 class="txt_pad">Merge</h2>
            <p class="txt">Pandas merge function works in a similar way to classic SQL joins but with data frames instead of tables. We specify the two data frames we want to merge, the relational fields and then define the join behaviour as you can see in the example below.
            </p>
            <div class="wide_box code_wide_box">
                <div class="code_box_wide">
                    <div class="txt2 code">
                        <div class="code_line">
                            combined_df = df1.merge(df2, on=<span class=string>'column_A'</span>,how=<span class=string>'inner'</span>)
                        </div>
                    </div>
                  </div>
            </div>

            <p class="txt2">We can use the <b>on</b> parameter to pass in the columns we want to join on as you can see above but this only works if the columns are named the same in both data frames. If not, then we can use the <b>left_on</b> and <b>right_on</b> parameters to tell Pandas which columns from the left should be matched with which columns in the right data frame.
            </p>
            <div class="wide_box code_wide_box">
                <div class="code_box_wide">
                    <div class="txt2 code">
                        <div class="code_line">
                            combined_df = df1.merge(df2, left_on=<span class=string>'column_A'</span>, right_on=<span class=string>'column_C'</span>,how=<span class=string>'inner'</span>)
                        </div>
                    </div>
                  </div>
            </div>
            <p class="txt2">We can also join on more than one column by passing a list of columns through the on parameters. The position of the column name in the list is used to find the corresponding column in the other list. For example the column listed first in the left_on list is used to match the column listed first in the right_on list.
            </p>
            <div class="wide_box code_wide_box">
                <div class="code_box_wide">
                    <div class="txt2 code">
                        <div class="code_line">
                            combined_df = df1.merge(df2, left_on=[<span class=string>'column_A'</span>,<span class=string>'column_B'</span>], right_on=[<span class=string>'column_C'</span>,<span class=string>'column_D'</span>],how=<span class=string>'inner'</span>)
                        </div>
                    </div>
                  </div>
            </div>
            <p class="txt2">For our project we have loaded our data into data frames and selected the columns we need so itâ€™s time to blend the separate data sources into one combined dataset so that we can do additional processing and then use the data for analysis or modelling.
            </p>
            <p class="txt2">Letâ€™s start by joining the orders and products data frames. Each order has one or more products and the product ID is listed in the orders data frame but without any further information. All we have is a meaningless identfier. 
            </p>
            <img class="output_image_50" alt="orders-dataframe" src="../img/learn-python-for-data-science/pandas-join-dataframes/orders-dataframe.png">
            <p class="txt2 txt_pad">Letâ€™s use Merge to combine the orders and product data frames using the Product_ID columns into a new data frame.
            </p>
            <div class="wide_box code_wide_box">
                <div class="code_box_wide">
                    <div class="txt2 code">
                        <div class="code_line">
                            df = orders.merge(products, on=<span class=string>'Product_ID'</span>)
                        </div>
                    </div>
                  </div>
            </div>
            <img class="output_image_80" alt="pandas-merge-dataframe" src="../img/learn-python-for-data-science/pandas-join-dataframes/pandas-merge-products.png">
            <p class="txt2 txt_pad">We now have infomration about the costs associateed with the procucts in the orders as well as more detail about what type of products they actually are.
            </p>
            <p class="txt2">Now we can join our other data frames to our new data frame. To understand which products have been returned we can join our returns data frame to our main df data frame. There are actually two relational columns between these data frames: order_no and product_id. This is because customers can order multiple products but only return some of them. Also, as not every product will be returned, some of our orders will not be contained in the returns data frame therefore using the default inner join behaviour will result in us excluding non-returned orders from our combined data frame. In this case we will need to use a left outer join which can be declared by passing the parameter how=â€˜leftâ€™.
            </p>
            <div class="wide_box code_wide_box">
                <div class="code_box_wide">
                    <div class="txt2 code">
                        <div class="code_line">
                            df = df.merge(returns, on=[<span class=string>'Order_No'</span>,<span class=string>'Product_ID'</span>], how=<span class=string>'left'</span>)
                        </div>
                    </div>
                  </div>
            </div>
            <img class="output_image_80" alt="pandas-left-merge-dataframe" src="../img/learn-python-for-data-science/pandas-join-dataframes/pandas-merge-returns.png">
            <h2 class="txt_pad">Concat</h2>
            <p class="txt">The concat function works much like a Union in SQL. We can pass a list of data frames to the concat function and as default Pandas will match any column names and glue the column from the 2nd data frame to the bottom of the corresponding column in the first data frame. Any non matching columns will still be included but will show NAs in the records that belong to the data frame that is missing this column.
            </p>

            <h4 class=txt_pad style="text-align: center;">DF1</h4>
            <img class="output_image_80" style="width:15%;" src="../img/learn-python-for-data-science/pandas-join-dataframes/pandas-dataframe-1.png">
            <h4 class=txt_pad style="text-align: center;">DF2</h4>
            <img class="output_image_80" style="width:20%;" src="../img/learn-python-for-data-science/pandas-join-dataframes/pandas-dataframe-2.png">
            <p class=txt_pad></p>
            <div class="wide_box code_wide_box">
                <div class="code_box_wide">
                    <div class="txt2 code">
                        <div class="code_line">
                            new_df = pd.concat([df1,df2])
                        </div>
                    </div>
                  </div>
            </div>
            <img class="output_image_80" style="width:27%;" src="../img/learn-python-for-data-science/pandas-join-dataframes/pandas-concat.png" alt="pandas-concat-dataframe">
            <p class="txt2 txt_pad">By default, any non-matching columns will still be included in the resulting data frame but will show NAs in the records that belong to the data frame that is missing this column, as is the case above. If we want to exclude non-matching columns we can pass the parameter join=â€˜innerâ€™.
            </p>
            <div class="wide_box code_wide_box">
                <div class="code_box_wide">
                    <div class="txt2 code">
                        <div class="code_line">
                            new_df = pd.concat([df1,df2],how=<span class=string>"inner"</span>)
                        </div>
                    </div>
                  </div>
            </div>
            <img class="output_image_80" style="width:15%;" src="../img/learn-python-for-data-science/pandas-join-dataframes/pandas-inner-concat.png" alt="pandas-inner-concat-dataframe">
            <p class="txt2 txt_pad">We can also use the concat function to perform the same operation but matching row names instead of columns by passing the axis=1 parameter.
            </p>
            <div class="wide_box code_wide_box">
                <div class="code_box_wide">
                    <div class="txt2 code">
                        <div class="code_line">
                            new_df = pd.concat([df1,df2],axis=<span class=number>1</span>)
                        </div>
                    </div>
                  </div>
            </div>
            <img class="output_image_80" style="width:30%;" src="../img/learn-python-for-data-science/pandas-join-dataframes/pandas-concat-axis-1.png" alt="pandas-concat-dataframe-axis>

            <h2 class="txt_pad">Exercises</h2>
            <p class="txt">We will also need to use the promotions data frame as part of our main data set. This data frame includes the discount rate for any products bought in a promo. We will need this to calculate what the customer actually paid. 
            </p>
            <p class="txt2">In addition the customer data frame gives us information about who is buying the products from the business and joining this to our other data will allow us to understand the behaviour of different types of customers.
            </p>
            <p class="txt2">For practice letâ€™s add these data frames to our main data frame:
            </p>
            <ol class="txt2">
                <li>Use merge to join the promotions data frame to the df data frame. <i>(Hint: Think about what join type to use here)</i></li>
                <li>Use merge to join the customers data frame to the df data frame.</li>
            </ol>
            <h2 class="txt_pad">Solutions</h2>
            <h4 class="txt_pad">Exercise 1</h4>
            <div class="wide_box code_wide_box">
                <div class="code_box_wide">
                    <div class="txt2 code">
                        <div class="code_line">
                            df = df.merge(promotions,on=[<span class=string>'PromoID'</span>],how=<span class=string>'left'</span>)
                        </div>
                    </div>
                  </div>
            </div>
            <img class="output_image_80" style="width:100%;" src="../img/learn-python-for-data-science/pandas-join-dataframes/pandas-merge-promos.png">
            <h4 class="txt_pad">Exercise 2</h4>
            <div class="wide_box code_wide_box">
                <div class="code_box_wide">
                    <div class="txt2 code">
                        <div class="code_line">
                            df = df.merge(customers,on=[<span class=string>'Customer_ID'</span>])
                        </div>
                    </div>
                  </div>
            </div>
            <img class="output_image_80" style="width:100%;" src="../img/learn-python-for-data-science/pandas-join-dataframes/pandas-merge-customers.png">
            
            <a href="python-pandas-cleaning-data.html" style="text-decoration: none;"><div id="next_mobile">Next</div></a>
            <!--AD BANNER-->
            <div class="ad_banner">
                    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                    <ins class="adsbygoogle"
                         style="display:block; text-align:center;"
                         data-ad-layout="in-article"
                         data-ad-format="fluid"
                         data-ad-client="ca-pub-4825364639199120"
                         data-ad-slot="8773565602"></ins>
                    <script>
                         (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
            </div>

        </div>
    </div>
    </div>
<!-------------------------------------FOOTER---------------------------------->
<div id="footer"></div>

        
<!--SIDE AD BAR-->
<div id="ad_bar" >
    <!-- side_bar_1 -->
    <ins class="adsbygoogle"
         style="display:block; margin-top: 10vh;"
         data-ad-client="ca-pub-4825364639199120"
         data-ad-slot="6532762683"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
    <script>
         (adsbygoogle = window.adsbygoogle || []).push({});
    </script>

</div>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>    

</body>
</html>